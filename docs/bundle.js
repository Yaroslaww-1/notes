!function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o(o.s=3)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Note=void 0;var n=o(8),i=o(9);function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class r{constructor({text:e="",createdAt:t=new Date,updatedAt:o=null,isSelected:r=!1,id:l=(0,i.createUUID)()}){s(this,"getTimestamp",()=>(0,n.getDayMonthYearFormat)(this.updatedAt?this.updatedAt:this.createdAt)),s(this,"getFullTimestamp",()=>this.updatedAt?this.updatedAt:this.createdAt),s(this,"getTextPreview",()=>this.text.slice(0,25)),s(this,"getTitle",()=>{if(""===this.text)return"New Note";let e="";if(this.text.includes("\n")){const t=Math.min(this.text.indexOf("\n"),35);e=this.text.slice(0,t+1)}else e=this.text.slice(0,35);return e}),s(this,"unselect",()=>this.isSelected=!1),s(this,"select",()=>this.isSelected=!0),this.id=l,this.isSelected=r,this.text=e,this.createdAt=t,this.updatedAt=o}}t.Note=r,s(r,"fromJsonParsed",e=>{const{id:t,text:o,createdAt:n,updatedAt:i,isSelected:s}=e;return new r({id:t,text:o,createdAt:new Date(n),updatedAt:i&&new Date(i),isSelected:s})})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setNotesListElement=t.createNotesListElement=void 0,o(14);var n=o(15);t.createNotesListElement=({notes:e,onNoteSelect:t})=>{const o=document.createElement("div");return o.className="notes-list",e.forEach(e=>{const i=(0,n.createNoteElement)({...e,title:e.getTitle(),textPreview:e.getTextPreview(),timestamp:e.getTimestamp(),onClick:()=>t(e)});o.appendChild(i)}),o};t.setNotesListElement=e=>{document.getElementsByClassName("notes-list")[0].replaceWith(e)}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setNoteEditElement=t.createNoteEditElement=void 0,o(17);t.createNoteEditElement=({note:e,isEditable:t=!1,onNoteEdit:o})=>{const n=document.createElement("textarea");return n.value=(null==e?void 0:e.text)||"",n.className="note-edit",t||n.setAttribute("disabled",!0),n.addEventListener("input",()=>{o(e,n.value)}),n};t.setNoteEditElement=e=>{document.getElementsByClassName("note-edit")[0].replaceWith(e)}},function(e,t,o){"use strict";o(4);var n=o(5),i=o(0),s=o(10),r=o(1),l=o(2),a=o(18);(async()=>{const e=new n.NotesService,t=(0,a.getIdFromUrl)(window.location.search);t&&e.selectNoteById(t),window.addEventListener("locationchange",()=>{const t=(0,a.getIdFromUrl)(window.location.search);e.selectNoteById(t)});const o=e=>{(0,a.setIdParam)(window.location.search,(0,a.getNoteUrl)(e),e=>{window.location.search=e.toString()})},d=t=>(0,s.createRootElement)({notes:e.getAllNotes(),selectedNote:e.getSelectedNote(),onNoteCreate:()=>e.addNote(new i.Note({})),onNoteDelete:()=>e.deleteSelectedNote(),onNoteSelect:o,onNoteEdit:(t,o)=>{t.text=o,e.updateNoteById(t.id,t)},isEditable:!!e.getSelectedNote(),...t});e.subscribe("updateNotes",()=>{(0,s.setRootElement)(d())}),e.subscribe("updateNotesList",()=>{console.log("updates",e.getSelectedNote()),(0,a.updateIdParam)(window.location.search,(0,a.getNoteUrl)(e.getSelectedNote()),e=>{console.log(e),window.history.replaceState(null,null,e)}),(0,r.setNotesListElement)((0,r.createNotesListElement)({notes:e.getAllNotes(),onNoteSelect:o}))}),e.subscribe("updateNoteEdit",()=>{(0,l.setNoteEditElement)((0,l.createNoteEditElement)({note:e.getSelectedNote(),isEditable:!0,onNoteEdit:(t,o)=>{t.text=o,e.updateNoteById(t.id,t)}}))}),(0,s.setRootElement)(d())})()},function(e,t,o){},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotesService=void 0;var n=o(6),i=o(7);function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=t.get(e);if(!o)throw new TypeError("attempted to get private field on non-instance");return o.get?o.get.call(e):o.value}var l=new WeakMap,a=new WeakMap;class d extends n.EventManager{constructor(){super(),s(this,"getAllNotes",()=>this.storage.getAll()),s(this,"addNote",e=>{r(this,l).call(this),this.storage.add(e),this.selectNote(e),r(this,a).call(this),this.notify("updateNotes")}),s(this,"deleteNote",e=>{this.storage.deleteById(e.id),this.notify("updateNotes")}),s(this,"deleteSelectedNote",()=>{const e=this.getSelectedNote();e&&(this.storage.deleteById(e.id),this.notify("updateNotes"))}),s(this,"selectNote",e=>{r(this,l).call(this),e.isSelected=!0,this.updateNoteById(e.id,e),this.notify("updateNoteEdit")}),s(this,"selectNoteById",e=>{r(this,l).call(this);const t=this.storage.get({id:e});t&&(t.isSelected=!0,this.storage.updateById(e,t),this.notify("updateNotesList"),this.notify("updateNoteEdit"))}),s(this,"getSelectedNote",()=>this.storage.get({isSelected:!0})),s(this,"updateNoteById",(e,t)=>{t.updatedAt=new Date,this.storage.updateById(e,t),r(this,a).call(this),this.notify("updateNotesList")}),l.set(this,{writable:!0,value:()=>{let e=this.storage.getAll();e=e.map(e=>(e.isSelected=!1,e)),this.storage.setAll(e),this.notify("updateNotes")}}),a.set(this,{writable:!0,value:()=>{const e=this.storage.getAll();e.sort((e,t)=>new Date(t.getFullTimestamp())-new Date(e.getFullTimestamp())),this.storage.setAll(e)}}),this.storage=new i.NoteStorage,r(this,l).call(this)}}t.NotesService=d},function(e,t,o){"use strict";function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;t.EventManager=class{constructor(){n(this,"subscribe",(e,t)=>{this.listeners.get(e)?this.listeners.get(e).push(t):this.listeners.set(e,[t])}),n(this,"unsubscribe",(e,t)=>{this.listeners.set(e,this.listeners.get(e).filter(e=>e!==t))}),n(this,"notify",(e,t)=>{this.listeners.get(e)&&this.listeners.get(e).forEach(e=>e(t))}),this.listeners=new Map}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoteStorage=void 0;var n=o(0);function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}t.NoteStorage=class{constructor(){i(this,"getAll",()=>{let e=JSON.parse(localStorage.getItem("notes"))||[];return e=e.map(e=>n.Note.fromJsonParsed(e)),e}),i(this,"add",e=>{let t=this.getAll();Array.prototype.push.apply(t,[e]),localStorage.setItem("notes",JSON.stringify(t))}),i(this,"deleteById",e=>{const t=this.getAll().filter(t=>t.id!==e);localStorage.setItem("notes",JSON.stringify(t))}),i(this,"get",e=>{const t=this.getAll().filter(t=>0===Object.keys(e).filter(o=>t[o]!==e[o]).length);if(0===t.length)return null;return n.Note.fromJsonParsed(t[0])}),i(this,"updateById",(e,t)=>{let o=this.getAll();o=o.map(o=>(o.id===e&&(o=t),o)),localStorage.setItem("notes",JSON.stringify(o))}),i(this,"setAll",e=>{localStorage.setItem("notes",JSON.stringify(e))})}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDayMonthYearFormat=void 0;t.getDayMonthYearFormat=e=>e.toLocaleString("default",{month:"long",year:"numeric",day:"numeric"})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createUUID=void 0;t.createUUID=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRootElement=t.createRootElement=void 0,o(11);var n=o(12),i=o(1),s=o(2);t.createRootElement=({notes:e,onNoteCreate:t,onNoteDelete:o,onNoteSelect:r,onNoteEdit:l,isEditable:a,selectedNote:d})=>{const c=document.createElement("div");c.setAttribute("id","root");const u=(0,n.createHeader)({onNoteCreate:t,onNoteDelete:o});c.appendChild(u);const h=document.createElement("div");h.className="main-content";const m=(0,i.createNotesListElement)({notes:e,onNoteSelect:r});h.appendChild(m);const p=(0,s.createNoteEditElement)({note:d,isEditable:a,onNoteEdit:l});return h.appendChild(p),c.appendChild(h),c};t.setRootElement=e=>{document.getElementById("root").replaceWith(e)}},function(e,t,o){},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createHeader=void 0,o(13);t.createHeader=({onNoteCreate:e,onNoteDelete:t})=>{const o=document.createElement("div");o.className="header";const n=document.createElement("button");n.innerHTML="Add note",n.addEventListener("click",e),o.appendChild(n);const i=document.createElement("button");return i.innerHTML="Delete note",i.addEventListener("click",t),o.appendChild(i),o}},function(e,t,o){},function(e,t,o){},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNoteElement=void 0,o(16);t.createNoteElement=({title:e,timestamp:t,textPreview:o,isSelected:n,onClick:i})=>{const s=document.createElement("div");s.className="note",n&&s.setAttribute("selected",!0),s.addEventListener("click",i);const r=document.createElement("div");r.className="header",r.innerHTML=e,s.appendChild(r);const l=document.createElement("div");l.className="content";const a=document.createElement("div");a.className="timestamp",a.innerHTML=t,l.appendChild(a);const d=document.createElement("div");return d.className="preview",d.innerHTML=o,l.appendChild(d),s.appendChild(l),s}},function(e,t,o){},function(e,t,o){},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNoteUrl=t.updateIdParam=t.setIdParam=t.getIdFromUrl=void 0;t.getIdFromUrl=e=>{const t=(new URLSearchParams(e).get("id")||"").split("_");return t[t.length-1]};t.setIdParam=(e,t,o)=>{const n=new URLSearchParams(e);n.set("id",t),o(n)};t.updateIdParam=(e,t,o)=>{o("?id="+t)};t.getNoteUrl=e=>`${e.getTitle()}_${e.id}`}]);